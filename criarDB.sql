/*

NOME: AXELL BRENDOW BATISTA MOREIRA
MATRÍCULA: 631822

COMANDO PARA CRIAR A BASE DE DADOS E RODAR TODAS AS QUERIES:
source criarDB.sql;

MySQL

*/

DROP DATABASE IF EXISTS BIBLIOTECA;

/* -------------------------- CRIA DATABASE -------------------------- */

CREATE DATABASE IF NOT EXISTS BIBLIOTECA;

USE BIBLIOTECA;

/* -------------------------- CRIA TABELAS E SUAS TUPLAS -------------------------- */

/* -------------------------- AUTOR -------------------------- */

CREATE TABLE IF NOT EXISTS AUTOR
(
    CODIGO INTEGER PRIMARY KEY AUTO_INCREMENT,
    NOMEAUT VARCHAR(255)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

INSERT INTO AUTOR (NOMEAUT) VALUES ('MACHADO DE ASSIS');
INSERT INTO AUTOR (NOMEAUT) VALUES ('NAVATHE');
INSERT INTO AUTOR (NOMEAUT) VALUES ('ELMASRI');

/* -------------------------- EDITORA -------------------------- */

CREATE TABLE IF NOT EXISTS EDITORA
(
    CODIGO INTEGER PRIMARY KEY AUTO_INCREMENT,
    NOMEEDIT VARCHAR(255)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

INSERT INTO EDITORA (NOMEEDIT) VALUES ('CAMPUS');
INSERT INTO EDITORA (NOMEEDIT) VALUES ('OHREALLY');
INSERT INTO EDITORA (NOMEEDIT) VALUES ('SARAIVA');
INSERT INTO EDITORA (NOMEEDIT) VALUES ('MAKRON BOOKS');
INSERT INTO EDITORA (NOMEEDIT) VALUES ('PEARSON');

/* -------------------------- ASSUNTO -------------------------- */

CREATE TABLE IF NOT EXISTS ASSUNTO
(
    CODIGO INTEGER PRIMARY KEY AUTO_INCREMENT,
    DESCRICAO VARCHAR(255)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

INSERT INTO ASSUNTO (DESCRICAO) VALUES ('Literatura Brasileira');

/* -------------------------- ALUNO -------------------------- */

CREATE TABLE IF NOT EXISTS ALUNO
(
    CODIGO INTEGER PRIMARY KEY AUTO_INCREMENT,
    NOME VARCHAR(255),
    DATANASC DATE,
    CIDADE VARCHAR(255)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

INSERT INTO ALUNO (NOME, DATANASC, CIDADE) VALUES ('Amanda Rhodes', '1997-03-07', 'Belo Horizonte');
INSERT INTO ALUNO (NOME, DATANASC, CIDADE) VALUES ('Bernardo Valadares', '1997-05-03', 'Governador Valadares');
INSERT INTO ALUNO (NOME, DATANASC, CIDADE) VALUES ('Ellen Simili', '1995-11-23', 'São Paulo');
INSERT INTO ALUNO (NOME, DATANASC, CIDADE) VALUES ('Marquinho', '1983-04-11', 'Porto Alegre');
INSERT INTO ALUNO (NOME, DATANASC, CIDADE) VALUES ('Fabiano', '1988-08-31', 'Poços de Caldas');

/* -------------------------- EMPRESTIMO -------------------------- */

CREATE TABLE IF NOT EXISTS EMPRESTIMO
(
    CODEMPREST INTEGER PRIMARY KEY AUTO_INCREMENT,
    DATA DATE,
    CODALUNO INTEGER,

    CONSTRAINT EMPRESTIMOALUNO FOREIGN KEY (CODALUNO) REFERENCES ALUNO(CODIGO)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

/* EMPRESTIMOS QUE O ALUNO 1 REALIZOU */
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-02-15', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-02-22', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-03-01', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-03-08', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-03-15', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-03-22', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-03-29', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-04-05', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-04-12', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-04-19', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-04-26', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-05-03', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-05-10', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-05-17', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-05-24', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-05-31', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-06-07', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-06-14', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-06-21', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-06-28', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-07-05', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-07-12', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-07-19', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-07-26', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-08-02', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-08-09', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-08-16', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-08-23', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-08-30', 1);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-09-06', 1);

/* EMPRESTIMOS QUE O ALUNO 2 REALIZOU */
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-02-15', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-02-22', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-03-01', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-03-08', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-03-15', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-03-22', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-03-29', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-04-05', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-04-12', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-04-19', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-04-26', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-05-03', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-05-10', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-05-17', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-05-24', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-05-31', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-06-07', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-06-14', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-06-21', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-06-28', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-07-05', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-07-12', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-07-19', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-07-26', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-08-02', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-08-09', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-08-16', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-08-23', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-08-30', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-09-06', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-09-13', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-09-20', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-09-27', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-10-04', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-10-11', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-10-18', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-10-25', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-11-01', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-11-08', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-11-15', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-11-22', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-11-29', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-12-06', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-12-13', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-12-20', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-12-27', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-01-03', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-01-10', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-01-17', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-01-24', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-01-31', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-02-07', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-02-14', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-02-21', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-02-28', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-03-06', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-03-13', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-03-20', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-03-27', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-04-03', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-04-10', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-04-17', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-04-24', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-05-01', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-05-08', 2);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-05-15', 2);

/* EMPRESTIMOS QUE O ALUNO 3 REALIZOU */
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-02-15', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-02-22', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-03-01', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-03-08', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-03-15', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-03-22', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-03-29', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-04-05', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-04-12', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-04-19', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-04-26', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-05-03', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-05-10', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-05-17', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-05-24', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-05-31', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-06-07', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-06-14', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-06-21', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-06-28', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-07-05', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-07-12', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-07-19', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-07-26', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-08-02', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-08-09', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-08-16', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-08-23', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-08-30', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-09-06', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-09-13', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-09-20', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-09-27', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-10-04', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-10-11', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-10-18', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-10-25', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-11-01', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-11-08', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-11-15', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-11-22', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-11-29', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-12-06', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-12-13', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-12-20', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2019-12-27', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-01-03', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-01-10', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-01-17', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-01-24', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-01-31', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-02-07', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-02-14', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-02-21', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-02-28', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-03-06', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-03-13', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-03-20', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-03-27', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-04-03', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-04-10', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-04-17', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-04-24', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-05-01', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-05-08', 3);
INSERT INTO EMPRESTIMO (DATA, CODALUNO) VALUES ('2020-05-15', 3);

/* -------------------------- LIVRO -------------------------- */

CREATE TABLE IF NOT EXISTS LIVRO
(
    CODIGO INTEGER PRIMARY KEY AUTO_INCREMENT,
    TITULO VARCHAR(255),
    ANOPUBLIC INTEGER,
    CODEDIT INTEGER,
    CODASSUNTO INTEGER,

    CONSTRAINT LIVROCODEDIT FOREIGN KEY (CODEDIT) REFERENCES EDITORA(CODIGO),

    CONSTRAINT LIVROCODASSUNTO FOREIGN KEY (CODASSUNTO) REFERENCES ASSUNTO(CODIGO)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

INSERT INTO LIVRO (TITULO, ANOPUBLIC, CODEDIT, CODASSUNTO) VALUES ('TITULO01', 2019, 1, 1);
INSERT INTO LIVRO (TITULO, ANOPUBLIC, CODEDIT, CODASSUNTO) VALUES ('TITULO02', 2019, 1, 1);
INSERT INTO LIVRO (TITULO, ANOPUBLIC, CODEDIT, CODASSUNTO) VALUES ('TITULO03', 2019, 2, 1);
INSERT INTO LIVRO (TITULO, ANOPUBLIC, CODEDIT, CODASSUNTO) VALUES ('TITULO04', 2019, 2, 1);
INSERT INTO LIVRO (TITULO, ANOPUBLIC, CODEDIT, CODASSUNTO) VALUES ('TITULO05', 2019, 2, 1);
INSERT INTO LIVRO (TITULO, ANOPUBLIC, CODEDIT, CODASSUNTO) VALUES ('TITULO06', 2019, 2, 1);
INSERT INTO LIVRO (TITULO, ANOPUBLIC, CODEDIT, CODASSUNTO) VALUES ('TITULO07', 2019, 3, 1);
INSERT INTO LIVRO (TITULO, ANOPUBLIC, CODEDIT, CODASSUNTO) VALUES ('TITULO08', 2019, 3, 1);
INSERT INTO LIVRO (TITULO, ANOPUBLIC, CODEDIT, CODASSUNTO) VALUES ('TITULO09', 2019, 3, 1);
INSERT INTO LIVRO (TITULO, ANOPUBLIC, CODEDIT, CODASSUNTO) VALUES ('TITULO10', 2019, 3, 1);
INSERT INTO LIVRO (TITULO, ANOPUBLIC, CODEDIT, CODASSUNTO) VALUES ('TITULO11', 2019, 3, 1);
INSERT INTO LIVRO (TITULO, ANOPUBLIC, CODEDIT, CODASSUNTO) VALUES ('TITULO12', 2019, 4, 1);

/* -------------------------- AUTORIA -------------------------- */

CREATE TABLE IF NOT EXISTS AUTORIA
(
    CODLIVRO INTEGER,
    CODAUTOR INTEGER,

    CONSTRAINT AUTORIACODLIVRO FOREIGN KEY (CODLIVRO) REFERENCES LIVRO(CODIGO),
    CONSTRAINT AUTORIACODAUTOR FOREIGN KEY (CODAUTOR) REFERENCES AUTOR(CODIGO)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

/* 7 livros do MACHADO DE ASSIS */
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (1, 1);
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (2, 1);
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (3, 1);
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (4, 1);
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (5, 1);
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (6, 1);
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (7, 1);

/* 6 livros do NAVATHE */
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (6, 2);
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (7, 2);
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (8, 2);
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (9, 2);
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (10, 2);
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (11, 2);

/* 7 livros do ELMASRI */
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (1, 3);
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (2, 3);
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (3, 3);
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (8, 3);
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (9, 3);
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (10, 3);
INSERT INTO AUTORIA (CODLIVRO, CODAUTOR) VALUES (11, 3);

/* -------------------------- EXEMPLAR -------------------------- */

CREATE TABLE IF NOT EXISTS EXEMPLAR
(
    CODEXEMPLAR INTEGER PRIMARY KEY AUTO_INCREMENT,
    CODLIVRO INTEGER,
    DATAAQUISICAO DATE,
    VALORAQUISICAO FLOAT(24),

    CONSTRAINT EXEMPLARCODLIVRO FOREIGN KEY (CODLIVRO) REFERENCES LIVRO(CODIGO)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

/* EXEMPLARES DO LIVRO 1 */
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (1, '2019-01-01', 2.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (1, '2019-01-08', 3.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (1, '2019-01-15', 4.2);

/* EXEMPLARES DO LIVRO 2 */
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (2, '2019-01-22', 5.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (2, '2019-01-29', 6.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (2, '2019-02-05', 7.2);

/* EXEMPLARES DO LIVRO 3 */
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (3, '2019-02-12', 8.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (3, '2019-02-19', 9.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (3, '2019-02-26', 10.2);

/* EXEMPLARES DO LIVRO 4 */
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (4, '2019-03-05', 11.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (4, '2019-03-12', 12.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (4, '2019-03-19', 13.2);

/* EXEMPLARES DO LIVRO 5 */
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (5, '2019-03-26', 14.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (5, '2019-04-02', 15.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (5, '2019-04-09', 16.2);

/* EXEMPLARES DO LIVRO 6 */
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (6, '2019-04-16', 17.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (6, '2019-04-23', 18.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (6, '2019-04-30', 19.2);

/* EXEMPLARES DO LIVRO 7 */
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (7, '2019-05-07', 20.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (7, '2019-05-14', 21.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (7, '2019-05-21', 22.2);

/* EXEMPLARES DO LIVRO 8 */
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (8, '2019-05-28', 23.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (8, '2019-06-04', 24.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (8, '2019-06-11', 25.2);

/* EXEMPLARES DO LIVRO 9 */
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (9, '2019-06-18', 26.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (9, '2019-06-25', 27.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (9, '2019-07-02', 28.2);

/* EXEMPLARES DO LIVRO 10 */
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (10, '2019-07-09', 29.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (10, '2019-07-16', 30.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (10, '2019-07-23', 31.2);

/* EXEMPLARES DO LIVRO 11 */
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (11, '2019-07-30', 32.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (11, '2019-08-06', 33.2);
INSERT INTO EXEMPLAR (CODLIVRO, DATAAQUISICAO, VALORAQUISICAO)
VALUES (11, '2019-08-13', 34.2);

/* -------------------------- ITEMEMPREST -------------------------- */

CREATE TABLE IF NOT EXISTS ITEMEMPREST
(
    CODEMPRESTITEM INTEGER,
    CODEXEMPLAR INTEGER,
    DATADEVOL DATE,
    MULTA FLOAT(24),

    CONSTRAINT ITEMEMPRESTCODEMPRESTITEM FOREIGN KEY (CODEMPRESTITEM)
    REFERENCES EMPRESTIMO(CODEMPREST),

    CONSTRAINT ITEMEMPRESTCODEXEMPLAR FOREIGN KEY (CODEXEMPLAR)
    REFERENCES EXEMPLAR(CODEXEMPLAR)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

/* ITENS EMPRESTADOS AO ALUNO 1 */
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (1, 1, '2019-02-16', 0);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (2, 2, '2019-02-23', 3.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (3, 3, '2019-03-02', 6.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (4, 4, '2019-03-09', 9.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (5, 5, '2019-03-16', 13);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (6, 6, '2019-03-23', 16.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (7, 7, '2019-03-30', 19.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (8, 8, '2019-04-06', 22.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (9, 9, '2019-04-13', 26);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (10, 10, '2019-04-20', 29.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (11, 11, '2019-04-27', 32.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (12, 12, '2019-05-04', 35.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (13, 13, '2019-05-11', 39);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (14, 14, '2019-05-18', 42.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (15, 15, '2019-05-25', 45.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (16, 16, '2019-06-01', 48.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (17, 17, '2019-06-08', 52);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (18, 18, '2019-06-15', 55.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (19, 19, '2019-06-22', 58.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (20, 20, '2019-06-29', 61.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (21, 21, '2019-07-06', 65);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (22, 22, '2019-07-13', 68.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (23, 23, '2019-07-20', 71.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (24, 24, '2019-07-27', 74.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (25, 25, '2019-08-03', 78);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (26, 26, '2019-08-10', 81.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (27, 27, '2019-08-17', 84.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (28, 28, '2019-08-24', 87.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (29, 29, '2019-08-31', 91);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (30, 30, '2019-09-07', 94.25);

/* ITENS EMPRESTADOS AO ALUNO 2 */
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (31, 1, '2019-02-16', 97.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (32, 2, '2019-02-23', 100.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (33, 3, '2019-03-02', 104);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (34, 4, '2019-03-09', 107.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (35, 5, '2019-03-16', 110.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (36, 6, '2019-03-23', 113.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (37, 7, '2019-03-30', 117);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (38, 8, '2019-04-06', 120.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (39, 9, '2019-04-13', 123.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (40, 10, '2019-04-20', 126.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (41, 11, '2019-04-27', 130);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (42, 12, '2019-05-04', 133.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (43, 13, '2019-05-11', 136.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (44, 14, '2019-05-18', 139.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (45, 15, '2019-05-25', 143);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (46, 16, '2019-06-01', 146.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (47, 17, '2019-06-08', 149.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (48, 18, '2019-06-15', 152.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (49, 19, '2019-06-22', 156);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (50, 20, '2019-06-29', 159.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (51, 21, '2019-07-06', 162.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (52, 22, '2019-07-13', 165.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (53, 23, '2019-07-20', 169);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (54, 24, '2019-07-27', 172.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (55, 25, '2019-08-03', 175.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (56, 26, '2019-08-10', 178.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (57, 27, '2019-08-17', 182);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (58, 28, '2019-08-24', 185.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (59, 29, '2019-08-31', 188.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (60, 30, '2019-09-07', 191.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (61, 22, '2019-09-14', 195);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (62, 23, '2019-09-21', 198.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (63, 24, '2019-09-28', 201.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (64, 25, '2019-10-05', 204.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (65, 26, '2019-10-12', 208);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (66, 27, '2019-10-19', 211.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (67, 28, '2019-10-26', 214.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (68, 29, '2019-11-02', 217.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (69, 30, '2019-11-09', 221);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (70, 22, '2019-11-16', 224.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (71, 23, '2019-11-23', 227.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (72, 24, '2019-11-30', 230.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (73, 25, '2019-12-07', 234);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (74, 26, '2019-12-14', 237.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (75, 27, '2019-12-21', 240.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (76, 28, '2019-12-28', 243.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (77, 29, '2020-01-04', 247);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (78, 30, '2020-01-11', 250.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (79, 22, '2020-01-18', 253.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (80, 23, '2020-01-25', 256.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (81, 24, '2020-02-01', 260);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (82, 25, '2020-02-08', 263.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (83, 26, '2020-02-15', 266.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (84, 27, '2020-02-22', 269.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (85, 28, '2020-02-29', 273);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (86, 29, '2020-03-07', 276.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (87, 30, '2020-03-14', 279.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (88, 22, '2020-03-21', 282.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (89, 23, '2020-03-28', 286);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (90, 24, '2020-04-04', 289.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (91, 25, '2020-04-11', 292.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (92, 26, '2020-04-18', 295.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (93, 27, '2020-04-25', 299);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (94, 28, '2020-05-02', 302.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (95, 29, '2020-05-09', 305.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (96, 30, '2020-05-16', 308.75);

/* ITENS EMPRESTADOS AO ALUNO 3 */
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (97, 1, '2019-02-16', 312);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (98, 2, '2019-02-23', 315.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (99, 3, '2019-03-02', 318.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (100, 4, '2019-03-09', 321.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (101, 5, '2019-03-16', 325);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (102, 6, '2019-03-23', 328.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (103, 7, '2019-03-30', 331.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (104, 8, '2019-04-06', 334.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (105, 9, '2019-04-13', 338);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (106, 10, '2019-04-20', 341.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (107, 11, '2019-04-27', 344.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (108, 12, '2019-05-04', 347.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (109, 13, '2019-05-11', 351);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (110, 14, '2019-05-18', 354.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (111, 15, '2019-05-25', 357.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (112, 16, '2019-06-01', 360.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (113, 17, '2019-06-08', 364);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (114, 18, '2019-06-15', 367.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (115, 19, '2019-06-22', 370.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (116, 20, '2019-06-29', 373.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (117, 21, '2019-07-06', 377);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (118, 22, '2019-07-13', 380.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (119, 23, '2019-07-20', 383.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (120, 24, '2019-07-27', 386.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (121, 25, '2019-08-03', 390);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (122, 26, '2019-08-10', 393.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (123, 27, '2019-08-17', 396.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (124, 28, '2019-08-24', 399.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (125, 29, '2019-08-31', 403);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (126, 30, '2019-09-07', 406.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (127, 22, '2019-09-14', 409.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (128, 23, '2019-09-21', 412.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (129, 24, '2019-09-28', 416);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (130, 25, '2019-10-05', 419.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (131, 26, '2019-10-12', 422.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (132, 27, '2019-10-19', 425.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (133, 28, '2019-10-26', 429);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (134, 29, '2019-11-02', 432.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (135, 30, '2019-11-09', 435.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (136, 22, '2019-11-16', 438.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (137, 23, '2019-11-23', 442);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (138, 24, '2019-11-30', 445.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (139, 25, '2019-12-07', 448.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (140, 26, '2019-12-14', 451.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (141, 27, '2019-12-21', 455);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (142, 28, '2019-12-28', 458.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (143, 29, '2020-01-04', 461.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (144, 30, '2020-01-11', 464.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (145, 22, '2020-01-18', 468);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (146, 23, '2020-01-25', 471.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (147, 24, '2020-02-01', 474.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (148, 25, '2020-02-08', 477.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (149, 26, '2020-02-15', 481);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (150, 27, '2020-02-22', 484.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (151, 28, '2020-02-29', 487.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (152, 29, '2020-03-07', 490.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (153, 30, '2020-03-14', 494);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (154, 22, '2020-03-21', 497.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (155, 23, '2020-03-28', 500.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (156, 24, '2020-04-04', 503.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (157, 25, '2020-04-11', 507);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (158, 26, '2020-04-18', 510.25);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (159, 27, '2020-04-25', 513.5);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (160, 28, '2020-05-02', 516.75);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (161, 29, '2020-05-09', 520);
INSERT INTO ITEMEMPREST (CODEMPRESTITEM, CODEXEMPLAR, DATADEVOL, MULTA)
VALUES (162, 30, '2020-05-16', 523.25);

/* -------------------------- CONSULTAS -------------------------- */

/* -------------------------- QUESTAO_03 -------------------------- */

SELECT LI.TITULO, LI.ANOPUBLIC, COUNT(EX.CODEXEMPLAR), AVG(EX.VALORAQUISICAO) FROM LIVRO AS LI
/* Takes all exemplaries of a book */
INNER JOIN EXEMPLAR AS EX ON LI.CODIGO = EX.CODLIVRO
/* Takes the subject/topic of these books */
INNER JOIN ASSUNTO AS ASSU ON LI.CODASSUNTO = ASSU.CODIGO
WHERE EX.DATAAQUISICAO LIKE '2019%' AND ASSU.DESCRICAO = 'Literatura Brasileira'
GROUP BY LI.CODIGO;

/* -------------------------- QUESTAO_04 -------------------------- */

SELECT LI.TITULO, EM.DATA AS DATAEMPREST, IT.MULTA FROM ALUNO AS AL
/* Takes all the loans (empréstimos) of the student */
INNER JOIN EMPRESTIMO AS EM ON AL.CODIGO = EM.CODALUNO
/* Takes all the borrowed items */
INNER JOIN ITEMEMPREST AS IT ON EM.CODEMPREST = IT.CODEMPRESTITEM
/* Takes all the exemplaries */
INNER JOIN EXEMPLAR AS EX ON IT.CODEXEMPLAR = EX.CODEXEMPLAR
/* Takes all the books */
INNER JOIN LIVRO AS LI ON EX.CODLIVRO = LI.CODIGO
WHERE AL.NOME = 'Bernardo Valadares';

/* -------------------------- QUESTAO_05 -------------------------- */

SELECT AL.* FROM ALUNO AS AL
/* Takes all student with a code that is not present in emprestimo relation */
WHERE AL.CODIGO NOT IN (SELECT DISTINCT EM.CODALUNO FROM EMPRESTIMO AS EM);

/* -------------------------- QUESTAO_06 -------------------------- */

SELECT AL.NOME, COUNT(EM.CODALUNO) AS NUM_EMPREST FROM ALUNO AS AL
/* Takes all the loans (empréstimo) of the students */
LEFT JOIN EMPRESTIMO AS EM ON AL.CODIGO = EM.CODALUNO
GROUP BY AL.CODIGO;

/* -------------------------- QUESTAO_07 -------------------------- */

SELECT DISTINCT AU.NOMEAUT FROM AUTOR, ASSUNTO AS ASSU
/* Takes all books of the subject/topic */
INNER JOIN LIVRO AS LI ON ASSU.CODIGO = LI.CODASSUNTO
/* Takes all the relations between book and authorship */
INNER JOIN AUTORIA ON LI.CODIGO = AUTORIA.CODLIVRO
/* Takes all the authors with authorship */
INNER JOIN AUTOR AS AU ON AUTORIA.CODAUTOR = AU.CODIGO
WHERE ASSU.DESCRICAO = 'Literatura Brasileira';

/* -------------------------- QUESTAO_08 -------------------------- */

SELECT AL.NOME FROM ALUNO AS AL
/* Takes all the loans (empréstimos) of all students */
INNER JOIN EMPRESTIMO AS EM ON EM.CODALUNO = AL.CODIGO
/* Takes all the borrowed items */
INNER JOIN ITEMEMPREST AS IT ON IT.CODEMPRESTITEM = EM.CODEMPREST
/* Takes all exemplaries */
INNER JOIN EXEMPLAR AS EX ON EX.CODEXEMPLAR = IT.CODEXEMPLAR
WHERE EM.DATA LIKE '2019%' /* Limit loans to 2019 */
GROUP BY EM.CODALUNO /* Group loans by student */
HAVING COUNT(DISTINCT EX.CODLIVRO) > 9; /* Gets all different books the student got */

/* -------------------------- QUESTAO_09 -------------------------- */

SELECT NOMEAUT FROM AUTOR AS AU
WHERE AU.CODIGO IN (
    /* Select the tuples that has NAVATHE books but NAVATHE is not the author */
    SELECT AUTORIA.CODAUTOR FROM AUTORIA
    WHERE AUTORIA.CODLIVRO IN ( /* Gets all NAVATHE books */
        SELECT CODLIVRO FROM AUTORIA
        INNER JOIN AUTOR AS AU ON AUTORIA.CODAUTOR = AU.CODIGO
        WHERE AU.NOMEAUT = 'NAVATHE'
    )
    AND AUTORIA.CODAUTOR NOT IN ( /* Remove authorships of NAVATHE */
        SELECT CODIGO FROM AUTOR AS AU
        WHERE AU.NOMEAUT = 'NAVATHE'
    )
);

/* -------------------------- QUESTAO_10 -------------------------- */

SELECT AU.NOMEAUT FROM AUTORIA
INNER JOIN AUTOR AS AU ON AU.CODIGO = AUTORIA.CODAUTOR
GROUP BY AUTORIA.CODAUTOR
/* Get authors with more books than NAVATHE */
HAVING COUNT(AUTORIA.CODLIVRO) > (
    /* Count the codes of the books of NAVATHE */
    SELECT COUNT(AUTORIA.CODLIVRO) FROM AUTORIA
    INNER JOIN AUTOR AS AU ON AU.CODIGO = AUTORIA.CODAUTOR AND AU.NOMEAUT = 'NAVATHE'
);

/* -------------------------- QUESTAO_11 -------------------------- */

SELECT AL.NOME, AVG(IT.MULTA) FROM ALUNO AS AL
INNER JOIN EMPRESTIMO AS EM ON EM.CODALUNO = AL.CODIGO
INNER JOIN ITEMEMPREST AS IT ON IT.CODEMPRESTITEM = EM.CODEMPREST
GROUP BY EM.CODALUNO
HAVING AVG(IT.MULTA) > (
    /* Takes the average of the penalties of all student of Belo Horizonte */
    SELECT AVG(IT.MULTA) FROM ALUNO AS AL
    INNER JOIN EMPRESTIMO AS EM ON EM.CODALUNO = AL.CODIGO AND AL.CIDADE = 'Belo Horizonte'
    INNER JOIN ITEMEMPREST AS IT ON IT.CODEMPRESTITEM = EM.CODEMPREST
    GROUP BY EM.CODALUNO
);

/* -------------------------- QUESTAO_12 -------------------------- */

SELECT AL.NOME FROM ALUNO AS AL
INNER JOIN EMPRESTIMO AS EM ON EM.CODALUNO = AL.CODIGO
GROUP BY EM.CODALUNO
HAVING COUNT(EM.CODEMPREST) > (
    /* Takes the number of loans (empréstimos) of books of MACHADO DE ASSIS */
    SELECT COUNT(IT.CODEMPRESTITEM) FROM AUTOR AS AU
    INNER JOIN AUTORIA ON AUTORIA.CODAUTOR = AU.CODIGO
    INNER JOIN EXEMPLAR AS EX ON EX.CODLIVRO = AUTORIA.CODLIVRO
    INNER JOIN ITEMEMPREST AS IT ON IT.CODEXEMPLAR = EX.CODEXEMPLAR
    WHERE AU.NOMEAUT = 'MACHADO DE ASSIS'
);

/* -------------------------- QUESTAO_13 -------------------------- */

SELECT ED.NOMEEDIT FROM EDITORA AS ED
INNER JOIN LIVRO AS LI ON LI.CODEDIT = ED.CODIGO
GROUP BY LI.CODEDIT
HAVING COUNT(LI.CODIGO) > (
    /* Takes the number of books of the CAMPUS publishing company */
    SELECT COUNT(LI.CODIGO) FROM EDITORA AS ED
    INNER JOIN LIVRO AS LI ON LI.CODEDIT = ED.CODIGO AND ED.NOMEEDIT = 'CAMPUS'
    GROUP BY LI.CODEDIT
);

/* -------------------------- QUESTAO_14 -------------------------- */

SELECT LI.TITULO, AL.NOME FROM LIVRO AS LI
INNER JOIN EXEMPLAR AS EX ON EX.CODLIVRO = LI.CODIGO
INNER JOIN ITEMEMPREST AS IT ON IT.CODEXEMPLAR = EX.CODEXEMPLAR
INNER JOIN EMPRESTIMO AS EM ON EM.CODEMPREST = IT.CODEMPRESTITEM
INNER JOIN ALUNO AS AL ON EM.CODALUNO = AL.CODIGO
WHERE EM.DATA LIKE '2019-09%' AND TIMEDIFF(IT.DATADEVOL, EM.DATA) <= '48:00:00';

/* -------------------------- QUESTAO_15 -------------------------- */

SELECT LI.CODIGO, LI.TITULO FROM LIVRO AS LI
INNER JOIN EXEMPLAR AS EX ON EX.CODLIVRO = LI.CODIGO
INNER JOIN ITEMEMPREST AS IT ON IT.CODEXEMPLAR = EX.CODEXEMPLAR
GROUP BY EX.CODLIVRO
HAVING COUNT(CODEMPRESTITEM) = (
    /* Gets the max value */
    SELECT MAX(CONTAGENS_EMPRESTS.CONTAGEM_EMPREST) FROM
    ( /* Counts the loans (empréstimos) of each book */
        SELECT COUNT(CODEMPRESTITEM) AS CONTAGEM_EMPREST FROM LIVRO AS LI
        INNER JOIN EXEMPLAR AS EX ON EX.CODLIVRO = LI.CODIGO
        INNER JOIN ITEMEMPREST AS IT ON IT.CODEXEMPLAR = EX.CODEXEMPLAR
        GROUP BY EX.CODLIVRO
    ) AS CONTAGENS_EMPRESTS
);

/* -------------------------- QUESTAO_16 -------------------------- */

SELECT LI.TITULO, EX.CODEXEMPLAR FROM EDITORA AS ED
INNER JOIN LIVRO AS LI ON LI.CODEDIT = ED.CODIGO
INNER JOIN EXEMPLAR AS EX ON EX.CODLIVRO = LI.CODIGO
WHERE EX.VALORAQUISICAO > (
    /* Gets the average of aquisition price of the books of each publishing company */
    SELECT AVG(EX2.VALORAQUISICAO) FROM EDITORA AS ED2
    INNER JOIN LIVRO AS LI2 ON LI2.CODEDIT = ED2.CODIGO
    INNER JOIN EXEMPLAR AS EX2 ON EX2.CODLIVRO = LI2.CODIGO
    WHERE ED2.CODIGO = ED.CODIGO
);

/* -------------------------- QUESTAO_17 -------------------------- */

DELETE FROM ALUNO WHERE CODIGO NOT IN (
    SELECT DISTINCT AL2.CODIGO FROM (SELECT CODIGO FROM ALUNO) AS AL2
    INNER JOIN EMPRESTIMO AS EM ON EM.CODALUNO = AL2.CODIGO
);

/* -------------------------- QUESTAO_18 -------------------------- */

/* SELECT APENAS PARA VISUALIZAÇÃO DO ANTES E DEPOIS */
SELECT LI.CODIGO, ED.NOMEEDIT FROM EDITORA AS ED
INNER JOIN LIVRO AS LI ON LI.CODEDIT = ED.CODIGO;

UPDATE LIVRO SET CODEDIT = (
    SELECT CODIGO FROM EDITORA AS ED
    WHERE ED.NOMEEDIT = 'PEARSON'
)
WHERE CODEDIT = (
    SELECT CODIGO FROM EDITORA AS ED
    WHERE ED.NOMEEDIT = 'MAKRON BOOKS'
);

/* SELECT APENAS PARA VISUALIZAÇÃO DO ANTES E DEPOIS */
SELECT LI.CODIGO, ED.NOMEEDIT FROM EDITORA AS ED
INNER JOIN LIVRO AS LI ON LI.CODEDIT = ED.CODIGO;
